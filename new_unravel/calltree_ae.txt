In function read_k_file:
 k_file_name = mydoom_ae.K
URLDownloadToFileA
StartAddress
	ExitThread
	DeleteFileA
	CloseHandle
	memset
	WriteFile
	sub_4A9866
	CreateFileA
	lstrcatA
	lstrlenA
	GetTempPathA
sub_4A9139
	Sleep
	sub_4A9D2C
		GetProcAddress
		sub_4A9C6B
			sub_4A9C28
				sub_4A98CA
				memcpy
		LoadLibraryA
		GetModuleHandleA
	strstr
	sub_4A8AC1
		fclose
		strstr
		sub_4A817F
		fopen
		sub_4A9C6B
			sub_4A9C28
				sub_4A98CA
				memcpy
		sub_4A80F0
		sub_4A8825
			fclose
			sub_4A817F
			fopen
			sub_4AA92F
				GetTickCount
			sub_4A80F0
			ShellExecuteA
			CloseHandle
			WriteFile
			memset
			ExitThread
			CreateFileA
		sub_4A8A4A
			fclose
			fopen
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
		sub_4AA92F
			GetTickCount
	fclose
	sub_4A817F
	fopen
	sub_4A80F0
	sub_4A8825
		fclose
		sub_4A817F
		fopen
		sub_4AA92F
			GetTickCount
		sub_4A80F0
		ShellExecuteA
		CloseHandle
		WriteFile
		memset
		ExitThread
		CreateFileA
	sub_4A9C6B
		sub_4A9C28
			sub_4A98CA
			memcpy
main
	ExitProcess
	sub_4A959B
		sub_4ACBE4
			Sleep
			sub_4ACB38
				sub_4AC8AE
					FindClose
					FindNextFileA
					sub_4AC40A
						sub_4AC25A
							CloseHandle
							UnmapViewOfFile
							sub_4ABA4B
								sub_4AB9DB
									sub_4AB790
										sub_4A9894
										sub_4A9C6B
											sub_4A9C28
												sub_4A98CA
												memcpy
										tolower
									sub_4AB86E
										sub_4A9936
										sub_4A9894
										sub_4A9C6B
											sub_4A9C28
												sub_4A98CA
												memcpy
										lstrcmpA
										tolower
									lstrlenA
									sub_4AB615
										lstrlenA
										sub_4AB58B
											lstrcpyA
									sub_4AB37E
										lstrlenA
										sub_4A98CA
										tolower
								lstrlenA
								sub_4A9894
								lstrcpyA
								GetTickCount
								memset
								HeapAlloc
								GetProcessHeap
								lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4A9936
						CharLowerA
						lstrcpynA
					sub_4AC8AE
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindFirstFileA
					memset
				Sleep
				GetDriveTypeA
				lstrcpyA
				GetSystemDirectoryA
				memset
			sub_4ACA47
				sub_4AC8AE
					FindClose
					FindNextFileA
					sub_4AC40A
						sub_4AC25A
							CloseHandle
							UnmapViewOfFile
							sub_4ABA4B
								sub_4AB9DB
									sub_4AB790
										sub_4A9894
										sub_4A9C6B
											sub_4A9C28
												sub_4A98CA
												memcpy
										tolower
									sub_4AB86E
										sub_4A9936
										sub_4A9894
										sub_4A9C6B
											sub_4A9C28
												sub_4A98CA
												memcpy
										lstrcmpA
										tolower
									lstrlenA
									sub_4AB615
										lstrlenA
										sub_4AB58B
											lstrcpyA
									sub_4AB37E
										lstrlenA
										sub_4A98CA
										tolower
								lstrlenA
								sub_4A9894
								lstrcpyA
								GetTickCount
								memset
								HeapAlloc
								GetProcessHeap
								lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4A9936
						CharLowerA
						lstrcpynA
					sub_4AC8AE
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindFirstFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
			SetThreadPriority
			GetCurrentThread
			sub_4AC368
				sub_4AC25A
					CloseHandle
					UnmapViewOfFile
					sub_4ABA4B
						sub_4AB9DB
							sub_4AB790
								sub_4A9894
								sub_4A9C6B
									sub_4A9C28
										sub_4A98CA
										memcpy
								tolower
							sub_4AB86E
								sub_4A9936
								sub_4A9894
								sub_4A9C6B
									sub_4A9C28
										sub_4A98CA
										memcpy
								lstrcmpA
								tolower
							lstrlenA
							sub_4AB615
								lstrlenA
								sub_4AB58B
									lstrcpyA
							sub_4AB37E
								lstrlenA
								sub_4A98CA
								tolower
						lstrlenA
						sub_4A9894
						lstrcpyA
						GetTickCount
						memset
						HeapAlloc
						GetProcessHeap
						lstrcmpiA
					memset
					MapViewOfFile
					CreateFileMappingA
					GetFileSize
					CreateFileA
				RegCloseKey
				RegQueryValueExA
				memset
				RegOpenKeyExA
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
		sub_4AC3F5
		CreateThread
		sub_4ABF8A
		sub_4AA585
			sub_4AA43F
				CopyFileA
				lstrcatA
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
			sub_4AA2F9
				CopyFileA
				lstrcatA
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
			sub_4AA144
				lstrcatA
				CopyFileA
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
			sub_4A9F61
				lstrcatA
				CopyFileA
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
			sub_4A9DA2
				lstrcatA
				CopyFileA
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
				memset
			GetModuleFileNameA
		sub_4AE7C9
			sub_4AE70A
				RegCloseKey
				RegQueryValueExA
				DeleteFileA
				GetSystemDirectoryA
				RegDeleteValueA
				RegOpenKeyExA
			sub_4AE519
				fclose
				lstrcatA
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				fopen
				lstrlenA
				GetSystemDirectoryA
				fgets
				strstr
		sub_4A9488
			CloseHandle
			sub_4A81D8
				WriteFile
			CreateFileA
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
			fclose
			fopen
		sub_4A82EC
			GetLastError
			CreateMutexA
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
		Sleep
		ShellExecuteA
		sub_4A8514
			RegOpenKeyExA
			RegCloseKey
			RegSetValueExA
			lstrlenA
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
		sub_4A8322
			fclose
			fopen
			lstrcatA
			lstrlenA
			GetSystemDirectoryA
			lstrcpyA
			CopyFileA
			DeleteFileA
			CloseHandle
			GetFileAttributesA
			CreateFileA
			SetFileAttributesA
			GetTempPathA
			GetModuleFileNameA
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
		sub_4A9559
		sub_4A823D
			RegCloseKey
			RegCreateKeyExA
			RegOpenKeyExA
			sub_4A9C6B
				sub_4A9C28
					sub_4A98CA
					memcpy
		GetTickCount
	memset
	sub_4A985A
		GetTickCount
	sub_4A80F0
sub_4AA82E
	Sleep
	sub_4AA64E
		CloseHandle
		Sleep
		lstrcmpiA
		sub_4A9C6B
			sub_4A9C28
				sub_4A98CA
				memcpy
		sub_4AA5E3
			CloseHandle
		memset
sub_4AA84C
	GetTickCount
sub_4ABDAE
	ExitThread
	InterlockedDecrement
	sub_4ABD3F
		GlobalFree
		sub_4AE2F9
			sub_4AE1AA
				RegOpenKeyExA
				RegCloseKey
				RegEnumKeyA
				RegQueryValueExA
				sub_4ADEF4
					closesocket
					sub_4ADE57
						sub_4ADB86
							recv
						send
						lstrlenA
					send
					sub_4A9C6B
						sub_4A9C28
							sub_4A98CA
							memcpy
					sub_4ADE05
					connect
					socket
					lstrcpyA
					sub_4ADC59
						lstrcmpiA
						CharLowerA
						lstrlenA
				sub_4ADC24
					gethostbyname
					inet_addr
				memset
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
			sub_4A9866
			sub_4ADEF4
				closesocket
				sub_4ADE57
					sub_4ADB86
						recv
					send
					lstrlenA
				send
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				sub_4ADE05
				connect
				socket
				lstrcpyA
				sub_4ADC59
					lstrcmpiA
					CharLowerA
					lstrlenA
			sub_4ADC24
				gethostbyname
				inet_addr
			lstrcpyA
			sub_4ADC59
				lstrcmpiA
				CharLowerA
				lstrlenA
		sub_4ADA7F
			DeleteFileA
			sub_4AD9AA
				sub_4AD777
					CloseHandle
					sub_4AD713
						memcpy
					ReadFile
					memset
					CreateFileA
				sub_4A9C09
					lstrlenA
				lstrlenA
				sub_4A9D09
					sub_4A9C8E
						sub_4A98CA
						memcpy
				lstrcatA
				sub_4AD5BA
					sub_4A9866
					lstrcpyA
					sub_4A9D09
						sub_4A9C8E
							sub_4A98CA
							memcpy
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
			sub_4AD88A
				lstrcatA
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrlenA
				sub_4A9C09
					lstrlenA
				sub_4A96F8
					GetTimeZoneInformation
					GetLocalTime
					FileTimeToSystemTime
					FileTimeToLocalFileTime
				sub_4A9866
				sub_4A987E
					sub_4A9866
			GlobalFree
			GlobalAlloc
			sub_4AD332
				DeleteFileA
				CloseHandle
				GetFileSize
				CreateFileA
				GetModuleFileNameA
				sub_4ACE03
					CloseHandle
					WriteFile
					lstrlenA
					ReadFile
					SetFilePointer
					GetFileSize
					sub_4ACD8F
						SetFilePointer
						sub_4ACC0F
						ReadFile
					sub_4ACD0C
						GetSystemTime
					memset
					CreateFileA
				lstrcatA
				sub_4A9866
				lstrcpyA
				GetTempFileNameA
				GetTempPathA
			sub_4AD23B
				sub_4A9866
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
			sub_4AD104
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				sub_4A9866
			sub_4AD03E
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				sub_4A9866
				lstrcpyA
				sub_4A987E
					sub_4A9866
			memset
			lstrlenA
		sub_4ABCF4
			sub_4ABBF7
				lstrcmpiA
			sub_4ABC20
				GetTickCount
				lstrcpynA
				memset
				HeapAlloc
				GetProcessHeap
				sub_4AB35B
					HeapFree
					GetProcessHeap
			GetTickCount
			sub_4AB347
				sub_4AB242
					sub_4AB13E
						Sleep
						sub_4AAEBB
							closesocket
							HeapFree
							GetProcessHeap
							sub_4AAD55
								HeapFree
								GetProcessHeap
							sub_4AACC2
							memset
							HeapAlloc
							sub_4AAD74
								memcpy
								memset
								HeapAlloc
								GetProcessHeap
								sub_4AACC2
								sub_4AAC69
							recv
							sub_4AAB58
								sendto
								memcpy
								GetTickCount
								memset
							socket
					gethostbyname
					inet_addr
					HeapFree
					GetProcessHeap
					HeapAlloc
					GetProcAddress
					LoadLibraryA
					GetModuleHandleA
				sub_4AB174
					GetProcAddress
					LoadLibraryA
					lstrcpynA
					memset
					HeapAlloc
					GetProcessHeap
					GetModuleHandleA
		lstrcpynA
	InterlockedIncrement
sub_4ABE47
	CloseHandle
	CreateThread
	Sleep
	sub_4ABB2D
		sub_4ABA4B
			sub_4AB9DB
				sub_4AB790
					sub_4A9894
					sub_4A9C6B
						sub_4A9C28
							sub_4A98CA
							memcpy
					tolower
				sub_4AB86E
					sub_4A9936
					sub_4A9894
					sub_4A9C6B
						sub_4A9C28
							sub_4A98CA
							memcpy
					lstrcmpA
					tolower
				lstrlenA
				sub_4AB615
					lstrlenA
					sub_4AB58B
						lstrcpyA
				sub_4AB37E
					lstrlenA
					sub_4A98CA
					tolower
			lstrlenA
			sub_4A9894
			lstrcpyA
			GetTickCount
			memset
			HeapAlloc
			GetProcessHeap
			lstrcmpiA
		lstrcatA
		lstrcpyA
		sub_4A9866
		lstrcpynA
		sub_4A987E
			sub_4A9866
	GetTickCount
	sub_4AC400
	sub_4ABDED
		GetTickCount
		HeapFree
		GetProcessHeap
	sub_4A9D2C
		GetProcAddress
		sub_4A9C6B
			sub_4A9C28
				sub_4A98CA
				memcpy
		LoadLibraryA
		GetModuleHandleA
sub_4ABFAA
	sub_4A9ACE
		memcpy
		lstrlenA
	sub_4A9966
		memcpy
		lstrlenA
		WideCharToMultiByte
		memset
	sub_4A98EC
		tolower
	memcpy
sub_4AC097
	sub_4ABA4B
		sub_4AB9DB
			sub_4AB790
				sub_4A9894
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				tolower
			sub_4AB86E
				sub_4A9936
				sub_4A9894
				sub_4A9C6B
					sub_4A9C28
						sub_4A98CA
						memcpy
				lstrcmpA
				tolower
			lstrlenA
			sub_4AB615
				lstrlenA
				sub_4AB58B
					lstrcpyA
			sub_4AB37E
				lstrlenA
				sub_4A98CA
				tolower
		lstrlenA
		sub_4A9894
		lstrcpyA
		GetTickCount
		memset
		HeapAlloc
		GetProcessHeap
		lstrcmpiA
