In function read_k_file:
 k_file_name = mydoom_ag.K
URLDownloadToFileA
sub_4A1585
sub_4A15D2
sub_4A169E
	sub_4A1689
		sub_4A1676
StartAddress
	ExitThread
	DeleteFileA
	CloseHandle
	memset
	WriteFile
	sub_4A9D37
	CreateFileA
	lstrcatA
	lstrlenA
	GetTempPathA
sub_4A95B6
	Sleep
	sub_4AA1FC
		GetProcAddress
		sub_4AA1D9
			sub_4AA196
				sub_4A9D9A
				memcpy
		LoadLibraryA
		GetModuleHandleA
	strstr
	sub_4A8E87
		fclose
		strstr
		sub_4A866F
		fopen
		sub_4AA1D9
			sub_4AA196
				sub_4A9D9A
				memcpy
		sub_4A85E0
		sub_4A8D8C
			ShellExecuteA
			CloseHandle
			WriteFile
			memset
			ExitThread
			CreateFileA
		sub_4A8D15
			fclose
			fopen
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
		sub_4AADFF
			GetTickCount
	fclose
	sub_4A866F
	fopen
	sub_4A85E0
	sub_4A8D8C
		ShellExecuteA
		CloseHandle
		WriteFile
		memset
		ExitThread
		CreateFileA
	sub_4AA1D9
		sub_4AA196
			sub_4A9D9A
			memcpy
sub_4A9B0C
	GetTickCount
main
	ExitProcess
	sub_4A9A10
		sub_4AD0B4
			Sleep
			sub_4AD008
				sub_4ACD7E
					FindClose
					FindNextFileA
					sub_4AC8DA
						sub_4AC72A
							CloseHandle
							UnmapViewOfFile
							sub_4ABF1B
								sub_4ABEAB
									sub_4ABC60
										sub_4A9D64
										sub_4AA1D9
											sub_4AA196
												sub_4A9D9A
												memcpy
										tolower
									sub_4ABD3E
										sub_4A9E06
										sub_4A9D64
										sub_4AA1D9
											sub_4AA196
												sub_4A9D9A
												memcpy
										lstrcmpA
										tolower
									lstrlenA
									sub_4ABAE5
										lstrlenA
										sub_4ABA5B
											lstrcpyA
									sub_4AB84E
										lstrlenA
										sub_4A9D9A
										tolower
								lstrlenA
								sub_4A9D64
								lstrcpyA
								GetTickCount
								memset
								HeapAlloc
								GetProcessHeap
								lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4A9E06
						CharLowerA
						lstrcpynA
					sub_4ACD7E
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindFirstFileA
					memset
				Sleep
				GetDriveTypeA
				lstrcpyA
				GetSystemDirectoryA
				memset
			sub_4ACF17
				sub_4ACD7E
					FindClose
					FindNextFileA
					sub_4AC8DA
						sub_4AC72A
							CloseHandle
							UnmapViewOfFile
							sub_4ABF1B
								sub_4ABEAB
									sub_4ABC60
										sub_4A9D64
										sub_4AA1D9
											sub_4AA196
												sub_4A9D9A
												memcpy
										tolower
									sub_4ABD3E
										sub_4A9E06
										sub_4A9D64
										sub_4AA1D9
											sub_4AA196
												sub_4A9D9A
												memcpy
										lstrcmpA
										tolower
									lstrlenA
									sub_4ABAE5
										lstrlenA
										sub_4ABA5B
											lstrcpyA
									sub_4AB84E
										lstrlenA
										sub_4A9D9A
										tolower
								lstrlenA
								sub_4A9D64
								lstrcpyA
								GetTickCount
								memset
								HeapAlloc
								GetProcessHeap
								lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4A9E06
						CharLowerA
						lstrcpynA
					sub_4ACD7E
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindFirstFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
			SetThreadPriority
			GetCurrentThread
			sub_4AC838
				sub_4AC72A
					CloseHandle
					UnmapViewOfFile
					sub_4ABF1B
						sub_4ABEAB
							sub_4ABC60
								sub_4A9D64
								sub_4AA1D9
									sub_4AA196
										sub_4A9D9A
										memcpy
								tolower
							sub_4ABD3E
								sub_4A9E06
								sub_4A9D64
								sub_4AA1D9
									sub_4AA196
										sub_4A9D9A
										memcpy
								lstrcmpA
								tolower
							lstrlenA
							sub_4ABAE5
								lstrlenA
								sub_4ABA5B
									lstrcpyA
							sub_4AB84E
								lstrlenA
								sub_4A9D9A
								tolower
						lstrlenA
						sub_4A9D64
						lstrcpyA
						GetTickCount
						memset
						HeapAlloc
						GetProcessHeap
						lstrcmpiA
					memset
					MapViewOfFile
					CreateFileMappingA
					GetFileSize
					CreateFileA
				RegCloseKey
				RegQueryValueExA
				memset
				RegOpenKeyExA
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
		sub_4AC8C5
		CreateThread
		sub_4AC45A
		sub_4AAA55
			sub_4AA90F
				CopyFileA
				lstrcatA
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
			sub_4AA7C9
				CopyFileA
				lstrcatA
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
			sub_4AA614
				lstrcatA
				CopyFileA
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
			sub_4AA431
				lstrcatA
				CopyFileA
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
			sub_4AA272
				lstrcatA
				CopyFileA
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
				RegCloseKey
				RegQueryValueExA
				RegOpenKeyExA
				memset
			GetModuleFileNameA
		sub_4AEC99
			sub_4AEBDA
				RegCloseKey
				RegQueryValueExA
				DeleteFileA
				GetSystemDirectoryA
				RegDeleteValueA
				RegOpenKeyExA
			sub_4AE9E9
				fclose
				lstrcatA
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				fopen
				lstrlenA
				GetSystemDirectoryA
				fgets
				strstr
		sub_4A98FD
			CloseHandle
			sub_4A86C8
				WriteFile
			CreateFileA
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
			fclose
			fopen
		sub_4A87DC
			GetLastError
			CreateMutexA
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
		Sleep
		ShellExecuteA
		sub_4A8A04
			RegOpenKeyExA
			RegCloseKey
			RegSetValueExA
			lstrlenA
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
		sub_4A8812
			fclose
			fopen
			lstrcatA
			lstrlenA
			GetSystemDirectoryA
			lstrcpyA
			CopyFileA
			DeleteFileA
			CloseHandle
			GetFileAttributesA
			CreateFileA
			SetFileAttributesA
			GetTempPathA
			GetModuleFileNameA
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
		sub_4A99CE
		sub_4A872D
			RegCloseKey
			RegCreateKeyExA
			RegOpenKeyExA
			sub_4AA1D9
				sub_4AA196
					sub_4A9D9A
					memcpy
		GetTickCount
	memset
	sub_4A9D2B
		GetTickCount
	sub_4A85E0
	sub_4A1248
sub_4AACFE
	Sleep
	sub_4AAB1E
		CloseHandle
		Sleep
		lstrcmpiA
		sub_4AA1D9
			sub_4AA196
				sub_4A9D9A
				memcpy
		sub_4AAAB3
			CloseHandle
		memset
sub_4AAD1C
	GetTickCount
sub_4AC27E
	ExitThread
	InterlockedDecrement
	sub_4AC20F
		GlobalFree
		sub_4AE7C9
			sub_4AE67A
				RegOpenKeyExA
				RegCloseKey
				RegEnumKeyA
				RegQueryValueExA
				sub_4AE3C4
					closesocket
					sub_4AE327
						sub_4AE056
							recv
						send
						lstrlenA
					send
					sub_4AA1D9
						sub_4AA196
							sub_4A9D9A
							memcpy
					sub_4AE2D5
					connect
					socket
					lstrcpyA
					sub_4AE129
						lstrcmpiA
						CharLowerA
						lstrlenA
				sub_4AE0F4
					gethostbyname
					inet_addr
				memset
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
			sub_4A9D37
			sub_4AE3C4
				closesocket
				sub_4AE327
					sub_4AE056
						recv
					send
					lstrlenA
				send
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				sub_4AE2D5
				connect
				socket
				lstrcpyA
				sub_4AE129
					lstrcmpiA
					CharLowerA
					lstrlenA
			sub_4AE0F4
				gethostbyname
				inet_addr
			lstrcpyA
			sub_4AE129
				lstrcmpiA
				CharLowerA
				lstrlenA
		sub_4ADF4F
			DeleteFileA
			sub_4ADE7A
				sub_4ADC47
					CloseHandle
					sub_4ADBE3
						memcpy
					ReadFile
					memset
					CreateFileA
				sub_4AA0D9
					lstrlenA
				lstrlenA
				sub_4AA173
					sub_4AA0F8
						sub_4A9D9A
						memcpy
				lstrcatA
				sub_4ADA8A
					sub_4A9D37
					lstrcpyA
					sub_4AA173
						sub_4AA0F8
							sub_4A9D9A
							memcpy
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
			sub_4ADD5A
				lstrcatA
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrlenA
				sub_4AA0D9
					lstrlenA
				sub_4A9BC9
					GetTimeZoneInformation
					GetLocalTime
					FileTimeToSystemTime
					FileTimeToLocalFileTime
				sub_4A9D37
				sub_4A9D4E
					sub_4A9D37
			GlobalFree
			GlobalAlloc
			sub_4AD802
				DeleteFileA
				CloseHandle
				GetFileSize
				CreateFileA
				GetModuleFileNameA
				sub_4AD2D3
					CloseHandle
					WriteFile
					lstrlenA
					ReadFile
					SetFilePointer
					GetFileSize
					sub_4AD25F
						SetFilePointer
						sub_4AD0DF
						ReadFile
					sub_4AD1DC
						GetSystemTime
					memset
					CreateFileA
				lstrcatA
				sub_4A9D37
				lstrcpyA
				GetTempFileNameA
				GetTempPathA
			sub_4AD70B
				sub_4A9D37
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
			sub_4AD5D4
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				sub_4A9D37
			sub_4AD50E
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				sub_4A9D37
				lstrcpyA
				sub_4A9D4E
					sub_4A9D37
			memset
			lstrlenA
		sub_4AC1C4
			sub_4AC0C7
				lstrcmpiA
			sub_4AC0F0
				GetTickCount
				lstrcpynA
				memset
				HeapAlloc
				GetProcessHeap
				sub_4AB82B
					HeapFree
					GetProcessHeap
			GetTickCount
			sub_4AB817
				sub_4AB712
					sub_4AB60E
						Sleep
						sub_4AB38B
							closesocket
							HeapFree
							GetProcessHeap
							sub_4AB225
								HeapFree
								GetProcessHeap
							sub_4AB192
							memset
							HeapAlloc
							sub_4AB244
								memcpy
								memset
								HeapAlloc
								GetProcessHeap
								sub_4AB192
								sub_4AB139
							recv
							sub_4AB028
								sendto
								memcpy
								GetTickCount
								memset
							socket
					gethostbyname
					inet_addr
					HeapFree
					GetProcessHeap
					HeapAlloc
					GetProcAddress
					LoadLibraryA
					GetModuleHandleA
				sub_4AB644
					GetProcAddress
					LoadLibraryA
					lstrcpynA
					memset
					HeapAlloc
					GetProcessHeap
					GetModuleHandleA
		lstrcpynA
	InterlockedIncrement
sub_4AC317
	CloseHandle
	CreateThread
	Sleep
	sub_4ABFFD
		sub_4ABF1B
			sub_4ABEAB
				sub_4ABC60
					sub_4A9D64
					sub_4AA1D9
						sub_4AA196
							sub_4A9D9A
							memcpy
					tolower
				sub_4ABD3E
					sub_4A9E06
					sub_4A9D64
					sub_4AA1D9
						sub_4AA196
							sub_4A9D9A
							memcpy
					lstrcmpA
					tolower
				lstrlenA
				sub_4ABAE5
					lstrlenA
					sub_4ABA5B
						lstrcpyA
				sub_4AB84E
					lstrlenA
					sub_4A9D9A
					tolower
			lstrlenA
			sub_4A9D64
			lstrcpyA
			GetTickCount
			memset
			HeapAlloc
			GetProcessHeap
			lstrcmpiA
		lstrcatA
		lstrcpyA
		sub_4A9D37
		lstrcpynA
		sub_4A9D4E
			sub_4A9D37
	GetTickCount
	sub_4AC8D0
	sub_4AC2BD
		GetTickCount
		HeapFree
		GetProcessHeap
	sub_4AA1FC
		GetProcAddress
		sub_4AA1D9
			sub_4AA196
				sub_4A9D9A
				memcpy
		LoadLibraryA
		GetModuleHandleA
sub_4AC47A
	sub_4A9F9E
		memcpy
		lstrlenA
	sub_4A9E36
		memcpy
		lstrlenA
		WideCharToMultiByte
		memset
	sub_4A9DBC
		tolower
	memcpy
sub_4AC567
	sub_4ABF1B
		sub_4ABEAB
			sub_4ABC60
				sub_4A9D64
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				tolower
			sub_4ABD3E
				sub_4A9E06
				sub_4A9D64
				sub_4AA1D9
					sub_4AA196
						sub_4A9D9A
						memcpy
				lstrcmpA
				tolower
			lstrlenA
			sub_4ABAE5
				lstrlenA
				sub_4ABA5B
					lstrcpyA
			sub_4AB84E
				lstrlenA
				sub_4A9D9A
				tolower
		lstrlenA
		sub_4A9D64
		lstrcpyA
		GetTickCount
		memset
		HeapAlloc
		GetProcessHeap
		lstrcmpiA
