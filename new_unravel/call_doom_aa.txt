In function read_k_file:
 k_file_name = mydoom_aa.K
main
	ExitProcess
	sub_4ACA31
		sub_4AC751
			GetLastError
			CreateMutexA
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
		sub_4AE330
			Sleep
			sub_4AE22F
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				Sleep
				GetDriveTypeA
				lstrcpyA
				GetSystemDirectoryA
				memset
			sub_4AE130
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4AE031
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4ADF32
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4ADE33
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4AD593
				sub_4AD6CC
					FindClose
					FindFirstFileA
					sub_4AD8D2
						sub_4ADC67
							CloseHandle
							UnmapViewOfFile
							sub_4AD28E
								sub_4AF2D0
									lstrlenA
									sub_4AF40A
										sub_4AF4F9
											lstrlenA
											sub_4B3E15
											tolower
										sub_4AFE8D
											sub_4B3D3A
											tolower
										sub_4AFFE8
											sub_4B3F40
											sub_4B3D3A
											sub_4B3A73
												sub_4B39E0
													sub_4B3E15
													memcpy
											lstrcmpA
											tolower
										lstrlenA
										sub_4AFA61
											lstrlenA
											sub_4AFD2F
												lstrcpyA
									sub_4B3D3A
									lstrcpyA
									GetTickCount
									memset
									HeapAlloc
									GetProcessHeap
									lstrcmpiA
							memset
							MapViewOfFile
							CreateFileMappingA
							GetFileSize
							CreateFileA
						Sleep
						lstrcmpA
						sub_4B3F40
						CharLowerA
						lstrcpynA
					sub_4AD6CC
					Sleep
					lstrcatA
					lstrlenA
					lstrcpyA
					FindNextFileA
					memset
				lstrcatA
				lstrlenA
				GetWindowsDirectoryA
				GetEnvironmentVariableA
				memset
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			SetThreadPriority
			GetCurrentThread
			sub_4AE372
				sub_4ADC67
					CloseHandle
					UnmapViewOfFile
					sub_4AD28E
						sub_4AF2D0
							lstrlenA
							sub_4AF40A
								sub_4AF4F9
									lstrlenA
									sub_4B3E15
									tolower
								sub_4AFE8D
									sub_4B3D3A
									tolower
								sub_4AFFE8
									sub_4B3F40
									sub_4B3D3A
									sub_4B3A73
										sub_4B39E0
											sub_4B3E15
											memcpy
									lstrcmpA
									tolower
								lstrlenA
								sub_4AFA61
									lstrlenA
									sub_4AFD2F
										lstrcpyA
							sub_4B3D3A
							lstrcpyA
							GetTickCount
							memset
							HeapAlloc
							GetProcessHeap
							lstrcmpiA
					memset
					MapViewOfFile
					CreateFileMappingA
					GetFileSize
					CreateFileA
				RegCloseKey
				RegQueryValueExA
				memset
				RegOpenKeyExA
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
		sub_4AE314
		CreateThread
		sub_4B0960
		sub_4B45B0
			fclose
			fopen
			GetSystemDirectoryA
			fgets
			strstr
		sub_4ACFAF
			RegCloseKey
			RegDeleteValueA
			RegOpenKeyExA
		sub_4ACB60
			fclose
			fopen
			GetSystemDirectoryA
			fgets
			strstr
		sub_4AC93B
			RegOpenKeyExA
			RegCloseKey
			RegSetValueExA
			lstrlenA
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
		sub_4AC78C
			lstrcpyA
			GetFileAttributesA
			CopyFileA
			DeleteFileA
			CloseHandle
			CreateFileA
			SetFileAttributesA
			lstrcatA
			lstrlenA
			GetSystemDirectoryA
			GetTempPathA
			GetModuleFileNameA
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
		sub_4AC4A2
			LoadLibraryA
			GetFileAttributesA
			lstrcpyA
			CloseHandle
			sub_4AC390
				WriteFile
			CreateFileA
			lstrcatA
			lstrlenA
			GetSystemDirectoryA
			GetTempPathA
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
		sub_4AC64C
			RegCreateKeyExA
			RegCloseKey
			RegOpenKeyExA
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
		GetTickCount
	memset
	sub_4ACB39
	sub_4B3CDC
		GetTickCount
StartAddress
	ExitThread
	ShellExecuteA
	Sleep
	URLDownloadToFileA
sub_4AD027
	sub_4AD28E
		sub_4AF2D0
			lstrlenA
			sub_4AF40A
				sub_4AF4F9
					lstrlenA
					sub_4B3E15
					tolower
				sub_4AFE8D
					sub_4B3D3A
					tolower
				sub_4AFFE8
					sub_4B3F40
					sub_4B3D3A
					sub_4B3A73
						sub_4B39E0
							sub_4B3E15
							memcpy
					lstrcmpA
					tolower
				lstrlenA
				sub_4AFA61
					lstrlenA
					sub_4AFD2F
						lstrcpyA
			sub_4B3D3A
			lstrcpyA
			GetTickCount
			memset
			HeapAlloc
			GetProcessHeap
			lstrcmpiA
sub_4AD3B4
	sub_4B3F9E
		memcpy
		lstrlenA
		WideCharToMultiByte
		memset
	sub_4B3ED3
		tolower
	memcpy
sub_4B0909
	ExitThread
	InterlockedDecrement
	sub_4B058A
		GlobalFree
		sub_4B28A0
			sub_4B2CFE
				lstrcmpiA
				CharLowerA
				lstrlenA
			sub_4B3838
				RegOpenKeyExA
				RegCloseKey
				RegQueryValueExA
				sub_4B3088
					sub_4B2CFE
						lstrcmpiA
						CharLowerA
						lstrlenA
					closesocket
					sub_4B35DB
						sub_4B36E7
							recv
						send
						lstrlenA
					send
					sub_4B3A73
						sub_4B39E0
							sub_4B3E15
							memcpy
					sub_4B34FC
					connect
					socket
					lstrcpyA
				sub_4B2CA0
					gethostbyname
					inet_addr
				memset
				RegEnumKeyA
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4B3CEC
			sub_4B3088
				sub_4B2CFE
					lstrcmpiA
					CharLowerA
					lstrlenA
				closesocket
				sub_4B35DB
					sub_4B36E7
						recv
					send
					lstrlenA
				send
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
				sub_4B34FC
				connect
				socket
				lstrcpyA
			sub_4B2CA0
				gethostbyname
				inet_addr
			lstrcpyA
		sub_4B1110
			lstrlenA
			sub_4B1798
				DeleteFileA
				CloseHandle
				GetFileSize
				CreateFileA
				GetModuleFileNameA
				sub_4B0B7B
					CloseHandle
					WriteFile
					lstrlenA
					ReadFile
					SetFilePointer
					GetFileSize
					sub_4B1070
						SetFilePointer
						sub_4B09A0
						ReadFile
					sub_4B0F93
						GetSystemTime
					memset
					CreateFileA
				lstrcatA
				sub_4B3CEC
				lstrcpyA
				GetTempFileNameA
				GetTempPathA
			sub_4B1D43
				sub_4B262D
					CloseHandle
					sub_4B2803
						memcpy
					ReadFile
					memset
					CreateFileA
				sub_4B4573
					lstrlenA
				lstrlenA
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
				lstrcatA
				sub_4B23E5
					sub_4B3CEC
					lstrcpyA
				sub_4B21FF
					sub_4B3CEC
					lstrcpyA
				sub_4B1E94
					sub_4B3CEC
					lstrcpyA
			sub_4B1B9C
				lstrcatA
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
				lstrlenA
				sub_4B4573
					lstrlenA
				sub_4B3AB8
					GetTimeZoneInformation
					GetLocalTime
					FileTimeToSystemTime
					FileTimeToLocalFileTime
				sub_4B3CEC
				sub_4B3D16
					sub_4B3CEC
			GlobalFree
			DeleteFileA
			GlobalAlloc
			sub_4B15FE
				sub_4B3CEC
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
			sub_4B13BB
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
				sub_4B3CEC
			sub_4B1261
				sub_4B3A73
					sub_4B39E0
						sub_4B3E15
						memcpy
				sub_4B3CEC
				lstrcpyA
				sub_4B3D16
					sub_4B3CEC
			memset
		sub_4B04F0
			GetTickCount
			sub_4B034F
				lstrcmpiA
			sub_4B038D
				GetTickCount
				lstrcpynA
				memset
				HeapAlloc
				GetProcessHeap
				sub_4AF299
					HeapFree
					GetProcessHeap
			sub_4AEFA7
				sub_4AF12D
					HeapFree
					GetProcessHeap
					sub_4AE430
						Sleep
						sub_4AE488
							HeapFree
							GetProcessHeap
							closesocket
							sub_4AE890
								sendto
								sub_4AEA36
								GetTickCount
								memset
							sub_4AEC4D
								HeapFree
								GetProcessHeap
							sub_4AEB02
							memset
							HeapAlloc
							sub_4AEC7E
								memcpy
								memset
								HeapAlloc
								GetProcessHeap
								sub_4AEB02
								sub_4AEF23
							recv
							socket
					gethostbyname
					inet_addr
					HeapAlloc
					GetProcAddress
					LoadLibraryA
					GetModuleHandleA
				sub_4AEFD5
					LoadLibraryA
					lstrcpynA
					memset
					HeapAlloc
					GetProcessHeap
					GetProcAddress
					GetModuleHandleA
		lstrcpynA
	InterlockedIncrement
sub_4B0983
	sub_4B0719
		sub_4B44E1
			LoadLibraryA
			GetProcAddress
			sub_4B3A73
				sub_4B39E0
					sub_4B3E15
					memcpy
			GetModuleHandleA
		Sleep
		sub_4AE323
		GetTickCount
		sub_4B01B2
			sub_4AF2D0
				lstrlenA
				sub_4AF40A
					sub_4AF4F9
						lstrlenA
						sub_4B3E15
						tolower
					sub_4AFE8D
						sub_4B3D3A
						tolower
					sub_4AFFE8
						sub_4B3F40
						sub_4B3D3A
						sub_4B3A73
							sub_4B39E0
								sub_4B3E15
								memcpy
						lstrcmpA
						tolower
					lstrlenA
					sub_4AFA61
						lstrlenA
						sub_4AFD2F
							lstrcpyA
				sub_4B3D3A
				lstrcpyA
				GetTickCount
				memset
				HeapAlloc
				GetProcessHeap
				lstrcmpiA
			lstrcatA
			lstrcpyA
			sub_4B3CEC
			lstrcpynA
			sub_4B3D16
				sub_4B3CEC
		CloseHandle
		CreateThread
		sub_4B066F
			HeapFree
			GetProcessHeap
			GetTickCount
